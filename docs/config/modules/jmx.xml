<?xml version="1.0"?>
<section xmlns="http://docbook.org/ns/docbook" version="5">
  <title>jmx</title>
  <para>Perform checks against a JMX enabled service</para>
  <variablelist>
    <varlistentry>
      <term>loader</term>
      <listitem>
        <para>lua</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>object</term>
      <listitem>
        <para>noit.module.jezebel</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <section>
    <title>Check Configuration</title>
    <variablelist>
      <varlistentry>
        <term>port</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>\d+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The TCP port JMX is running on</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>username</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>Username needed to authenticate with</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>password</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>Password needed to authenticate with</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>mbean_domains</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>Space seperated list of domains to extract metrics for.  Default is all domains (no list specified)</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>uri</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>/jmxrmi</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The JMX URI endpoint to use. Default is "/jmxrmi"</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>mbean_properties_(.+)</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>List of properties in the form type=Foo,name=Bar that will filter out JMX objects that don't match at least one of these settings</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section>
    <title>Examples</title>
    <example>
      <title>JVM Statistics</title>
      <para/>
      <programlisting>
        &lt;noit&gt;
          &lt;modules&gt;
            &lt;module loader="lua" name="jmx" object="noit.module.jezebel"/&gt;
          &lt;/modules&gt;
          &lt;checks&gt;
            &lt;check uuid="ddceb610-4615-6a2f-f2d3-c7335f0044f9" module="jmx" target="127.0.0.1" period="60000" timeout="30000"&gt;
              &lt;config&gt;
                &lt;port&gt;3333&lt;/port&gt;
                &lt;uri&gt;/jmxrmi&lt;/uri&gt;
                &lt;mbean_domains&gt;java.lang java.nio&lt;/mbean_domains&gt;
                &lt;mbean_properties_0&gt;type=Memory&lt;/mbean_properties_0&gt;
                &lt;mbean_properties_1&gt;name=Code Cache,type=MemoryPool&lt;/mbean_properties_1&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/checks&gt;
        &lt;/noit&gt;
    </programlisting>
    </example>
  </section>
</section>
